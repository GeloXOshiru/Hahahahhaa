local UILib = {}
UILib.__index = UILib

function UILib.new(config)
    local self = setmetatable({}, UILib)
    
    self.title = config.title or "UI Library"
    self.x = config.x or 100
    self.y = config.y or 100
    self.width = config.width or 400
    self.height = config.height or 300
    self.theme = config.theme or {
        background = {0.15, 0.15, 0.15, 1},
        accent = {0.2, 0.6, 1, 1},
        text = {1, 1, 1, 1},
        header = {0.1, 0.1, 0.1, 1}
    }
    
    self.logo = nil
    if config.logoPath and love.filesystem.getInfo(config.logoPath) then
        self.logo = love.graphics.newImage(config.logoPath)
    end
    
    self.elements = {}
    self.visible = true
    
    return self
end

function UILib:toggle()
    self.visible = not self.visible
end

function UILib:draw()
    if not self.visible then return end

    love.graphics.setColor(self.theme.background)
    love.graphics.rectangle("fill", self.x, self.y, self.width, self.height, 8)

    love.graphics.setColor(self.theme.header)
    love.graphics.rectangle("fill", self.x, self.y, self.width, 50, 8)

    if self.logo then
        love.graphics.setColor(1, 1, 1, 1)
        local padding = 10
        local size = 30
        local scaleX = size / self.logo:getWidth()
        local scaleY = size / self.logo:getHeight()
        love.graphics.draw(self.logo, self.x + padding, self.y + 10, 0, scaleX, scaleY)
        
        love.graphics.setColor(self.theme.text)
        love.graphics.print(self.title, self.x + padding + size + 10, self.y + 18)
    else
        love.graphics.setColor(self.theme.text)
        love.graphics.print(self.title, self.x + 15, self.y + 18)
    end

    love.graphics.setColor(self.theme.accent)
    love.graphics.setLineWidth(2)
    love.graphics.rectangle("line", self.x, self.y, self.width, self.height, 8)

    for _, element in ipairs(self.elements) do
        element:draw(self.x, self.y)
    end
end

function UILib:addButton(text, callback)
    local button = {
        text = text,
        callback = callback,
        y_offset = #self.elements * 40 + 70
    }
    
    function button:draw(baseX, baseY)
        love.graphics.setColor(0.25, 0.25, 0.25, 1)
        love.graphics.rectangle("fill", baseX + 20, baseY + self.y_offset, 150, 30, 4)
        love.graphics.setColor(1, 1, 1, 1)
        love.graphics.print(self.text, baseX + 30, baseY + self.y_offset + 8)
    end
    
    table.insert(self.elements, button)
    return button
end

return UILib
